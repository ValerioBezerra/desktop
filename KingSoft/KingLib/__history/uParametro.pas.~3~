unit uParametro;

interface

uses
  SysUtils, Forms, Dialogs, IniFiles;

type
  TParametro = class
  private
    FIdEmpresa: Integer;
    FTabela: String;
    FOperacao: String;
    FDados: OleVariant;
  public
    constructor Create();
    property IdEmpresa: String read FIdEmpresa write FIdEmpresa;
    property Tabela: String read FTabela write FTabela;
    property Operacao: String read FOperacao write FOperacao;
    property Dados: String read FDados write FDados;
end;

implementation

{ TConexao }

constructor TConexao.Create;
var
  IniFile: TIniFile;
begin
  if (FileExists(ExtractFilePath(Application.ExeName) + 'config.ini')) then
    begin
      IniFile   := TIniFile.Create(ExtractFilePath(Application.ExeName) + 'config.ini');
      DataBase  := IniFile.ReadString('Conexao', 'DataBase', '');
      Server    := IniFile.ReadString('Conexao', 'Server', '');
      VendorLib := IniFile.ReadString('Conexao', 'VendorLib', '');
      IniFile.Free;
    end
  else
    ShowMessage('Arquivo config.ini não encontrado');
end;

end.

